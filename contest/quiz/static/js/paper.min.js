for(var t=0,o=new Array(pcnt),e=$("#timer").val(),n=$.ajax({url:"test.txt",async:!1}).responseText.split("|"),i=0;i<pcnt;i++)o[i]=-1;function r(t){return(t<10?"0":"")+t.toString()}var c=!1,s=!1;function a(){if(!s){switch(timeleft=e-Date.parse(new Date)/1e3,timestr=r(parseInt(timeleft/60))+":"+r(timeleft%60),$(".navbar_time").text(timestr),document.title="答题("+timestr+") - 军旅知识竞赛",!0){case timeleft<=30:$(".navbar_time").css("color","red"),c||(c=!0,layer.alert(n[0],{icon:7}));break;case timeleft<=60:$(".navbar_time").css("color","orange");break;case timeleft<=900:$(".navbar_time").css("color","blue")}0<timeleft?setTimeout(function(){a()},1e3):(layer.msg(n[2],{time:1300}),f())}}function l(){for(var t="",e=0;e<pcnt;e++)t+=(0==e?"":"#")+o[e].toString();return t}function u(t,e){layer.open({title:"交卷错误",content:t+"<br/>errcode="+e.toString(),icon:2})}function f(){$.ajax({url:"control/judger.php",type:"POST",data:{answer:l()},cache:!1,success:function(t){try{obj=$.parseJSON(t)}catch(t){return void u("服务器出现错误，请稍后再尝试交卷!",2)}if(obj.success){var e=$("#score");e.html(obj.score),obj.score<60?e.css("color","red"):e.css("color","green"),layer.open({type:1,title:"提示",content:$("#result"),clostBtn:!1,icon:1,btn:["返回首页","查看答卷"],yes:function(){window.location="index.php"},btn2:function(){window.location="info.php"}}),s=!0,$(window).unbind(),$this=$("#submit_button"),$this.prop("disabled",!0),$("#back_button").show()}else u(obj.err_message,3)},error:function(){u("服务器出现错误，请稍后再尝试交卷!",1)}})}$("#submit_button").click(function(){for(var t,e,n=!0,i=0;i<pcnt;i++)-1==o[i]&&(n=!1);n?(t="是否确认交卷？",e=3):(t="您仍有题目未作答，确认交卷？",e=7),layer.confirm(t,{icon:e,title:"交卷",yes:function(t){layer.close(t),f()}})});var b=$("#problems"),d=$("body");$(window).blur(function(){3<++t?f():layer.open({title:"提示",content:n[1]+t.toString()+"<br/>"+n[3],icon:7})}),$(window).bind("beforeunload",function(){return 1}),b.find(".list-group").find("a").click(function(){$this=$(this);var t=b.find(".list-group").index($this.parent()),e=$this.parent().find("a").index($this);-1!=o[t]&&$this.parent().find("a").eq(o[t]).removeClass("active"),$this.addClass("active"),o[t]=e}),layer.msg("答题开始",{icon:1,time:1300}),a();